@model MyCinema.ViewModels.SelectTicketViewModel
@{
    string Poster_path = $"https://image.tmdb.org/t/p/original{Model.PosterPath}";
}
<div class="container mt-4">
    <!-- Movie Details Section -->
    <div class="row">
        <div class="col-md-4 text-center">
            <img src="@Poster_path" alt="@Model.Title" class="img-fluid rounded">
        </div>
        <div class="col-md-8">
            <h1>@Model.Title</h1>
            <p class="text-muted">@Model.Language | @string.Join(", ", Model.Genres)</p>
            <p><strong>Salon:</strong> @Model.SalonNumber</p>
            <p><strong>Show Time:</strong> @Model.ShowTime?.ToString("dd.MM.yyyy, HH:mm")</p>
                <!-- Ticket Selection Section -->
    <div class="row mt-4">
        <div class="col-md-12">
            <h3 class="mb-4">Select Your Tickets</h3>
            <table class="table table-bordered">
                <thead class="thead-dark">
                    <tr>
                        <th>Ticket Type</th>
                        <th>Price (лв.)</th>
                        <th class="text-center">Quantity</th>
                    </tr>
                </thead>
                <tbody>
                            @foreach (var ticket in Model.TicketTypes)
                            {
                                <tr>
                                    <td>@ticket.Name</td>
                                    <td>@ticket.Price.ToString("F2")</td>
                                    <td class="text-center">
                                        <div class="btn-group" role="group" aria-label="Quantity controls">
                                            <button class="btn btn-sm btn-outline-secondary" onclick="updateQuantity('@ticket.Name', -1)">-</button>
                                            <span class="px-3" id="quantity-@ticket.Name">@ticket.Quantity</span>
                                            <button class="btn btn-sm btn-outline-secondary" onclick="updateQuantity('@ticket.Name', 1)">+</button>
                                        </div>
                                    </td>
                                </tr>

                            }
                </tbody>
            </table>
        </div>
    </div>
        <!-- Total Price Section -->
    <div class="row mt-4">
        <div class="col-md-12 text-right">
            <h4>Total: <span id="total-price">0.00</span> лв.</h4>
        </div>
    </div>

    <!-- Continue Button -->
    <div class="row mt-4">
        <div class="col-md-12 text-center">
            <button class="btn btn-warning btn-lg w-100">Continue</button>
        </div>
    </div>
</div>
        </div>
    </div>


<script>
    const ticketTypes = @Html.Raw(Json.Serialize(Model.TicketTypes));

    function updateQuantity(ticketName, change) {
        const ticket = ticketTypes.find(t => t.name === ticketName);
        if (ticket) {
            ticket.quantity = Math.max(0, ticket.quantity + change);
            document.getElementById(`quantity-${ticketName}`).innerText = ticket.quantity;
            updateTotalPrice();
        }
    }

    function updateTotalPrice() {
        let totalPrice = 0;
        ticketTypes.forEach(t => totalPrice += t.price * t.quantity);
        document.getElementById('total-price').innerText = totalPrice.toFixed(2);
    }
</script>
